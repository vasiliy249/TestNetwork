В данном документе описывается разрабатываемый стандарт протокола передачи данных в децентрализованной сети. Протокол предназначен для надёжной передачи больших объёмов данных «особым» участникам сети.

Работа сети по рассматриваемому протоколу осуществляется по принципу распределённой хэш-таблицы (DHT) с использованием пространства, метрика которого основана на операциях над IP адресами (?). Топология пространства обладает таким свойством, что обмен данными между узлами увеличивает полезную информацию, хранящуюся в сети (знание друг друга узлов).

На каждом узле работает UDP и TCP сервер (каждый из которых ответственен за обработку своих команд).

Каждый узел имеет композитный идентифкатор: IP адрес + 160-битный идентификатор.

Первая часть используется для маршрутизации и в качестве аргумента метрики (?).

Вторая часть используется для идентификации не только узлов, но и передаваемых данных.

Основные определения:

initial list – список, содержащий актуальную информацию о существующих участниках сети

bootstrap-узел – специализированный узел сети, поддерживающий initial list в актуальном состоянии и обеспечивающий новых участников сети этой информацией. В непосредственной передаче данных не участвует. Адреса bootstrap-узлов заранее известны и hard-coded.

k-buckets – контейнер с информацией об узлах, построенный с использованием метрики, представляет собой бинарное дерево. Хранится на каждом узле и используется для оптимизации маршрутизации.

Основные команды (TBD: идентификаторы команд должны быть строками или байтами?):

PING – сообщение с целью проверки соединения.
В состав сообщения входит идентификатор команды, 160b ID отправителя. В состав ответа входит идентифкатор команды, 160b ID получателя.

NEW DATA – сообщение, целью которого является оповещение участников сети о появлении новых данных в сети, требующих «доставки» в специальные узлы.
В состав сообщения входит 160b ID данных, 160b ID отпрвителя, размер данных, разбиение данных (?)

GET INIT – сообщение, в ответ на которое, bootstrap узел отправляет список узлов (?)

GET NEED (?) – сообщение от агента центральному узлу, с целью получения идентификаторов данных, которые необходимы центральному узлу

STORE – передача данных ...

Алгоритм работы сети при добавлении нового участника:
* регистрация нового участника в общем реестре и выдача идентификатора узла (или же он сам генерирует рандомный идентификатор)
* получение initial list от bootstrap-узла(ов)
* генерация своих k-buckets на основе initial list, ping этих узлов.

Алгоритм работы сети при получении новых данных:
* передача в сеть по udp сообщения о новых данных (содержит ID или IP узла, у которого появились данные, ID данных, размер)
* узел, которому необходимо передать данные (как правило, исследовательский центр), переходит в состоние «необходимы такие-то данные» и начинает отвечать на запросы GET NEED от других узлов
* узлы, опросившие центр и получившие список идентификаторов необходимых данных ... ?
